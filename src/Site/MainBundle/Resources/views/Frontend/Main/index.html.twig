{% extends 'SiteMainBundle:Frontend:layout.html.twig' %}

{% from 'SiteMainBundle:Frontend/News:macros.html.twig' import listTab %}
{% from 'SiteMainBundle:Frontend/GroupCompany:macros.html.twig' import listTabGroup %}
{% from 'SiteMainBundle:Frontend/News:macros.html.twig' import listSidebarNews %}

{% block title %}{% if app.request.attributes.get('_route') == 'frontend_group_company_one' %}{{ groupCompany.metaTitle }}{% else %}{{ page.metaTitle }}{% endif %}{% endblock %}
{% block meta_description %}{% if app.request.attributes.get('_route') == 'frontend_group_company_one' %}{{ groupCompany.metaDescription }}{% else %}{{ page.metaDescription }}{% endif %}{% endblock %}
{% block meta_keywords %}{% if app.request.attributes.get('_route') == 'frontend_group_company_one' %}{{ groupCompany.metaKeywords }}{% else %}{{ page.metaKeywords }}{% endif %}{% endblock %}
{% block og_title %}{% if app.request.attributes.get('_route') == 'frontend_group_company_one' %}{{ groupCompany.title }}{% else %}{{ page.metaTitle }}{% endif %}{% endblock %}
{% block og_description %}{% if app.request.attributes.get('_route') == 'frontend_group_company_one' %}{{ groupCompany.metaDescription }}{% else %}{{ page.metaDescription }}{% endif %}{% endblock %}
{% block og_image %}{% if app.request.attributes.get('_route') == 'frontend_group_company_one' %}http://{{ app.request.host }}{{ image(groupCompany.webPath).zoomCrop(300, 300) }}{% else %}http://{{ app.request.host }}{{ image('bundles/sitemain/frontend/images/logo.png').zoomCrop(300, 300) }}{% endif %}{% endblock %}
{% block image_src %}{% if app.request.attributes.get('_route') == 'frontend_group_company_one' %}http://{{ app.request.host }}{{ image(groupCompany.webPath).zoomCrop(300, 300) }}{% else %}http://{{ app.request.host }}{{ image('bundles/sitemain/frontend/images/logo.png').zoomCrop(300, 300) }}{% endif %}{% endblock %}

{% block content %}
    <!-- Main -->
    <section class="main">
        <div class="CursorAnimateRotate">
            <div class="slider">
                {% for slider in sliders %}
                    <div {% if slider.webPath|length > 0 %}style="background: url('{{ asset(slider.webPath) }}') center center no-repeat; background-size: cover;"{% endif %} {% if slider.video|length > 0 %}data-video='{{ asset('uploads/background/' ~ slider.video) }}' class="video"{% endif %}>
                        <div class="wrap-sticker">
                            <div class="sticker revealOnScroll" data-animation="fadeInRight">
                                <div class="wrap">
                                    {{ slider.text|raw }}
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>

            <div class="cursor"><div class="cursorIcon"></div></div>
        </div>

        <a href="#{{ pages[1].slug }}" class="icon-arrow revealOnScroll" data-animation="fadeInUp"></a>
    </section>
    <!-- end Main -->

    <!-- Posts -->
    {#<section class="page" >#}
        {#<section class="posts-block bg-posts-block" id="posts">#}
            {#{{ listTabGroup(groupCompanies) }}#}
        {#</section>#}
    {#</section>#}
    <!-- end Posts -->

    <!-- News -->
    {#<section class="news-block">#}
        {#<div class="inner-news-block">#}
            {#<h2 class="revealOnScroll" data-animation="fadeInLeft">Новости группы компаний</h2>#}

            {#{{ listSidebarNews(news) }}#}
        {#</div>#}
    {#</section>#}
    <!-- end News -->

    {# Структура #}
    <section class="page" id="{{ pages[1].slug }}">
        {{ render(url('frontend_group_company_index')) }}
    </section>

    {# О нас #}
    <section class="page" id="{{ pages[2].slug }}">
        {{ render(url('frontend_content_index', {slug: pages[2].slug})) }}
    </section>

    {# Руководство #}
    <section class="page" id="{{ pages[3].slug }}">
        {{ render(url('frontend_director_index')) }}
    </section>

    {# Социальная деятельность #}
    <section class="page" id="{{ pages[4].slug }}">
        {{ render(url('frontend_social_activities_index')) }}
    </section>

    {# Новости #}
    <section class="page" id="{{ pages[5].slug }}">
        {{ render(url('frontend_news_index')) }}
    </section>

    {# Контакты #}
    <section class="page" id="{{ pages[6].slug }}">
        {{ render(url('frontend_content_index', {slug: pages[6].slug})) }}
    </section>



    {#<!-- Text -->#}
    {#<section class="text">#}
        {#<div class="content">#}
            {#{{ page.text|raw }}#}
        {#</div>#}
    {#</section>#}
    {#<!-- end Text -->#}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% if app.request.get('slug') %}
        <script type="text/javascript">
            jQuery(function(){
                if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                    jQuery(window).load(function () {
                        {% if app.request.attributes.get('_route') == 'frontend_page_index' %}
                            jQuery('.nav-pills a[href="#{{ app.request.get('slug') }}"]').parent().addClass('current');
                            enable_scroll();
                            console.log(jQuery('#{{ app.request.get('slug') }}').offset().top);
                            jQuery(window).scrollTop(jQuery('#{{ app.request.get('slug') }}').offset().top);
                            disable_scroll(jQuery('#{{ app.request.get('slug') }}').offset().top);
                        {% elseif app.request.attributes.get('_route') == 'frontend_group_company_one' %}
                            jQuery('.nav-pills a[href="#struktura"]').parent().addClass('current');
                            enable_scroll();
                            console.log(jQuery('#struktura').offset().top);
                            jQuery(window).scrollTop(jQuery('#struktura').offset().top);
                            disable_scroll(jQuery('#struktura').offset().top);
                            $('#{{ app.request.get('slug') }}').find('.card__image').trigger('click');
                        {% endif %}
                    });
                }
            });
        </script>
    {% endif %}
{% endblock %}